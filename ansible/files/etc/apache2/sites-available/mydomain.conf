<VirtualHost *:80>
    ServerName {{mydomain}}
    ServerAlias www.{{mydomain}}
    Redirect / https://www.{{mydomain}}
</VirtualHost>

<VirtualHost *:443>
    ServerName {{mydomain}}
    Redirect / https://www.{{mydomain}}

    SSLEngine On
    SSLCertificateFile /etc/letsencrypt/live/{{mydomain}}/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/{{mydomain}}/privkey.pem
</VirtualHost>

<VirtualHost *:443>
    ServerName www.{{mydomain}}
    ServerAdmin webmaster@{{mydomain}}
    DocumentRoot /var/www/{{mydomain}}/www/public
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    SSLEngine On
    SSLCertificateFile /etc/letsencrypt/live/{{mydomain}}/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/{{mydomain}}/privkey.pem

    <Directory /var/www/{{mydomain}}/www/public>
        AllowOverride All
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost>
